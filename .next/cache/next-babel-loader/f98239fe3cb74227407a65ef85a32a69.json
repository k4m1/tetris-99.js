{"ast":null,"code":"import { createTracing } from \"trace_events\";\nvar canvas = document.getElementById('tetris');\nvar context = canvas.getContext('2d');\ncontext.scale(20, 20);\ncontext.fillStyle = '#000';\ncontext.fillRect(0, 0, canvas.clientWidth, canvas.height);\n\nvar collision = function collision(playArea, player) {\n  var _ref = [player.matrix, player.pos],\n      m = _ref[0],\n      o = _ref[1];\n\n  for (var y = 0; y < m.length; y++) {\n    for (var x = 0; x < m[y].length; x++) {\n      if (m[y][x] !== 0 && (playArea[y + o.y] && playArea[y + o.y][x + o.x]) !== 0) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n};\n\nvar createMatrix = function createMatrix(width, height) {\n  var matrix = []; // while height is not 0\n\n  while (height--) {\n    matrix.push(new Array(width).fill(0));\n  }\n\n  return matrix;\n};\n\nvar createTetris = function createTetris(type) {\n  if (type === 'T') {\n    return [[0, 0, 0], [1, 1, 1], [0, 1, 0]];\n  } else if (type === 'O') {\n    return [[2, 2], [2, 2]];\n  } else if (type === 'L') {\n    return [[0, 3, 0], [0, 3, 0], [0, 3, 3]];\n  } else if (type === 'J') {\n    return [[0, 4, 0], [0, 4, 0], [4, 4, 0]];\n  } else if (type === 'I') {\n    return [[0, 5, 0, 0], [0, 5, 0, 0], [0, 5, 0, 0], [0, 5, 0, 0]];\n  } else if (type === 'S') {\n    return [[0, 6, 6], [6, 6, 0], [0, 0, 0]];\n  } else if (type === 'Z') {\n    return [[7, 7, 0], [0, 7, 7], [0, 0, 0]];\n  }\n};\n\nvar draw = function draw() {\n  context.fillStyle = '#000';\n  context.fillRect(0, 0, canvas.clientWidth, canvas.height);\n  drawMatrix(playArea, {\n    x: 0,\n    y: 0\n  });\n  drawMatrix(player.matrix, player.pos);\n};\n\nvar drawMatrix = function drawMatrix(nmatrix, offset) {\n  matrix.forEach(function (row, y) {\n    row.forEach(function (value, x) {\n      if (value != 0) {\n        context.fillStyle = colors[value];\n        context.fillRect(x + offset.x, y + offset.y, 1, 1);\n      }\n    });\n  });\n};\n\nvar merge = function merge(playArea, player) {\n  player.matrix.forEach(function (row, y) {\n    row.forEach(function (value, x) {\n      if (value !== 0) {\n        playArea[y + player.pos.y][x + player.pos.x] = value;\n      }\n    });\n  });\n};\n\nvar playerDrop = function playerDrop() {\n  player.pos.y++;\n\n  if (collision(playArea, player)) {\n    player.pos.y--;\n    merge(playArea, player);\n    playerReset();\n  }\n\n  dropCounter = 0;\n};\n\nvar playerMove = function playerMove(direction) {\n  player.pos.x += direction;\n\n  if (collision(playArea, player)) {\n    player.pos.x -= direction;\n  }\n};\n\nvar playerReset = function playerReset() {\n  var tetrises = \"ILJOTSZ\";\n  player.matrix = createTetris(tetrises[tetrises.length * Math.random() | 0]);\n  player.pos.y = 0;\n  player.pos.x = (playArea[0].length / 2 | 0) - (player.matrix[0].length / 2 | 0);\n\n  if (collision(playArea, player)) {\n    playArea.forEach(function (row) {\n      return row.fill(0);\n    });\n  }\n};\n\nvar playerRotation = function playerRotation(direction) {\n  var offset = 1;\n  rotate(player.matrix, direction);\n\n  while (collision(playArea, player)) {\n    player.pos.x += offset;\n    offset = -(offset + (offset > 0 ? 1 : -1));\n\n    if (offset > player.matrix[0].length) {\n      rotate(player.matrix, -dir);\n      player.pos.x = pos;\n      return;\n    }\n  }\n};\n\nvar rotate = function rotate(matrix, direction) {\n  for (var y = 0; y < matrix.length; y++) {\n    for (var x = 0; x < y; x++) {\n      var _ref2 = [matrix[y][x], matrix[x][y]];\n      matrix[x][y] = _ref2[0];\n      matrix[y][x] = _ref2[1];\n    }\n  }\n\n  if (direction > 0) {\n    matrix.forEach(function (row) {\n      return row.reverse();\n    });\n  } else {\n    matrix.reverse();\n  }\n};\n\nvar dropCounter = 0;\nvar dropInterval = 1000;\nvar lastTime = 0;\n\nvar update = function update() {\n  var time = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  var deltatime = time - lastTime;\n  lastTime = time;\n  dropCounter += deltatime;\n\n  if (dropCounter > dropInterval) {\n    playerDrop();\n  }\n\n  draw();\n  requestAnimationFrame(update);\n};\n\nvar playArea = createMatrix(12, 20);\nvar player = {\n  pos: {\n    x: 5,\n    y: 5\n  },\n  matrix: createTetris('T')\n}; // These event listners will move the player left or right by incremnting the x plane\n// the 'down' control sets our 'dropCounter' to zero which tirggers a 'move' down one position\n\ndocument.addEventListener('keydown', function (e) {\n  if (e.keyCode === 37) {\n    playerMovement(-1);\n  } else if (e.keyCode === 39) {\n    playerMovement(1);\n  } else if (e.keyCode === 40) {\n    playerDrop();\n  } else if (e.keyCode === 81) {\n    playerRotation(-1);\n  } else if (e.keyCode === 87) {\n    playerRotation(1);\n  }\n});\nvar colors = [null, 'purple', 'yellow', 'blue', 'orange', 'light blue', 'green', 'red'];\nupdate();","map":{"version":3,"sources":["/Users/bebop/Desktop/GitHub Reasources /websocket-tetris/pages/index.js"],"names":["createTracing","canvas","document","getElementById","context","getContext","scale","fillStyle","fillRect","clientWidth","height","collision","playArea","player","matrix","pos","m","o","y","length","x","createMatrix","width","push","Array","fill","createTetris","type","draw","drawMatrix","nmatrix","offset","forEach","row","value","colors","merge","playerDrop","playerReset","dropCounter","playerMove","direction","tetrises","Math","random","playerRotation","rotate","dir","reverse","dropInterval","lastTime","update","time","deltatime","requestAnimationFrame","addEventListener","e","keyCode","playerMovement"],"mappings":"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","sourcesContent":["import { createTracing } from \"trace_events\";\n\nconst canvas = document.getElementById('tetris');\nconst context = canvas.getContext('2d');\n\ncontext.scale(20,20);\n\ncontext.fillStyle = '#000';\ncontext.fillRect(0,0, canvas.clientWidth, canvas.height);\n\n\n\n\nconst collision = (playArea, player) => {\n    const [m, o] = [player.matrix, player.pos];\n    for (let y = 0; y < m.length; y++) {\n        for (let x = 0; x < m[y].length; x++) {\n            if (m[y][x] !== 0 && (playArea[y + o.y] && playArea[y + o.y][x + o.x]) !== 0) {\n                return true\n\n            }\n        }\n    }\n    return false\n}\n\nconst createMatrix = (width, height) => {\n    const matrix = [];\n    // while height is not 0\n    while (height--) {\n        matrix.push(new Array(width).fill(0));\n    }\n    return matrix\n\n}\n\nconst createTetris = type => {\n    if (type === 'T') {\n        return [\n            [0, 0, 0],\n            [1, 1, 1],\n            [0, 1, 0],\n        ];\n    } else if (type === 'O') {\n        return [\n            [2, 2],\n            [2, 2],\n        ];\n    } else if (type === 'L') {\n        return [\n            [0, 3, 0],\n            [0, 3, 0],\n            [0, 3, 3],\n        ];\n    } else if (type === 'J') {\n        return [\n            [0, 4, 0],\n            [0, 4, 0],\n            [4, 4, 0],\n        ];\n    } else if (type === 'I') {\n        return [\n            [0, 5, 0, 0],\n            [0, 5, 0, 0],\n            [0, 5, 0, 0],\n            [0, 5, 0, 0],\n        ];\n    } else if (type === 'S') {\n        return [\n            [0, 6, 6],\n            [6, 6, 0],\n            [0, 0, 0],\n        ];\n    } else if (type === 'Z') {\n        return [\n            [7, 7, 0],\n            [0, 7, 7],\n            [0, 0, 0],\n        ];\n    }\n}\n\n\nconst draw = () => {\n    context.fillStyle = '#000';\n    context.fillRect(0, 0, canvas.clientWidth, canvas.height);\n    drawMatrix(playArea, {x: 0, y: 0})\n    drawMatrix(player.matrix, player.pos)\n}\n\nconst drawMatrix = (nmatrix, offset) => {\n    \n    matrix.forEach((row, y) => {\n        row.forEach((value, x) => {\n            if (value != 0) {\n                context.fillStyle = colors[value];\n                context.fillRect(x + offset.x, y + offset.y, 1, 1);\n            }\n        });\n    });\n}\n\nconst merge = (playArea, player) => {\n    player.matrix.forEach((row, y) => {\n        row.forEach((value, x) => {\n            if (value !== 0 ) {\n                playArea[y + player.pos.y][x + player.pos.x] = value\n            }\n        })\n    })\n}\n\n\nconst playerDrop = () => {\n    player.pos.y++;\n    if (collision(playArea, player)) {\n        player.pos.y--;\n        merge(playArea, player);\n        playerReset();\n    }\n    dropCounter = 0;\n}\n\nconst playerMove = direction => {\n    player.pos.x += direction;\n    if (collision(playArea, player)) {\n        player.pos.x -= direction;\n    }\n}\n\nconst playerReset = () => {\n    const tetrises = \"ILJOTSZ\";\n    player.matrix= createTetris(tetrises[tetrises.length * Math.random() | 0]);\n    player.pos.y = 0;\n    player.pos.x = (playArea[0].length / 2 | 0) - (player.matrix[0].length / 2 | 0);\n    if (collision(playArea, player)) {\n        playArea.forEach(row => row.fill(0));\n    }\n}\n\nconst playerRotation = (direction) => {\n    let offset = 1\n    rotate(player.matrix, direction)\n    while (collision(playArea, player)) {\n        player.pos.x += offset;\n        offset = -(offset + (offset > 0 ? 1 : -1));\n        if (offset > player.matrix[0].length) {\n            rotate(player.matrix, -dir);\n            player.pos.x = pos;\n            return;\n        }\n    }\n}\n\n\nconst rotate = (matrix, direction) => {\n    for (let y = 0; y < matrix.length; y++ ) {\n        for (let x = 0; x < y; x++) {\n            [\n                matrix[x][y],\n                matrix[y][x],\n            ] = [\n                matrix[y][x], \n                matrix[x][y],\n            ]\n        }\n    }\n\n    if (direction > 0) {\n        matrix.forEach(row => row.reverse())\n    } else {\n        matrix.reverse();\n    }\n\n}\n\n\nlet dropCounter = 0;\nlet dropInterval = 1000;\n\nlet lastTime = 0\n\nconst update = (time = 0) => {\n    const deltatime = time - lastTime;\n    lastTime = time\n\n    dropCounter += deltatime\n    if (dropCounter > dropInterval) {\n        playerDrop()\n    }\n    draw();\n    requestAnimationFrame(update);\n\n}\n\nconst playArea = createMatrix(12, 20);\n\n\nconst player = {\n    pos: { x: 5, y: 5},\n    matrix: createTetris('T'),\n}\n\n// These event listners will move the player left or right by incremnting the x plane\n// the 'down' control sets our 'dropCounter' to zero which tirggers a 'move' down one position\ndocument.addEventListener('keydown', e => {\n    if (e.keyCode === 37) {\n        playerMovement(-1);\n    } else if (e.keyCode === 39) {\n        playerMovement(1);\n    } else if (e.keyCode === 40) {\n        playerDrop()\n    } else if (e.keyCode === 81) {\n        playerRotation(-1)\n    } else if (e.keyCode === 87) {\n        playerRotation(1)\n    }\n\n})\n\nconst colors = [\nnull,\n'purple',\n'yellow',\n'blue',\n'orange',\n'light blue',\n'green',\n'red'\n]\n\nupdate()\n"]},"metadata":{},"sourceType":"module"}